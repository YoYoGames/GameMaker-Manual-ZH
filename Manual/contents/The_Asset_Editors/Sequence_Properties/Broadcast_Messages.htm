<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>广播信息</title>
  <meta name="generator" content="Adobe RoboHelp 2020" />
  <link rel="stylesheet" href="../../assets/css/default.css" type="text/css" />
  <script src="../../assets/scripts/main_script.js"></script>
  <meta name="rh-authors" content="Mark Alexander" />
  <meta name="topic-comment" content="Page detailing the dope sheet" />
  <meta name="rh-index-keywords" content="Sequences - Broadcast Messages, Moments" />
  <meta name="search-keywords" content="broadcast,messages,broadcast messages,moments" />
</head>
<body>
  <!--<div class="body-scroll" style="top: 150px;">-->
  <h1>广播信息</h1>
  <p><a href="../Sequences.htm">序列</a>和<a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sprites/Sprites.htm">精灵</a>都可以在其长度上的任何一点产生所谓的<strong>广播信息</strong>。这些信息是简单的<span class="notranslate">strings</span> ，它们被添加到动画的特定帧中<span class="notranslate">timeline</span> ，当到达<span class="notranslate">timeline</span> ，然后<span class="notranslate">string</span> ，将被广播给所有监听它的实例。任何拥有<a href="../Object_Properties/Other_Events.htm">广播消息事件</a>（在<strong>&quot;其他</strong>&quot;事件类别中找到）的实例都会在到达<span class="notranslate">string</span> ，收到消息<span class="notranslate">timeline</span> ，这时就需要你有一些代码来解析它并作出相应的反应。还要注意的是，<span class="notranslate">sequences</span> 也可以监听广播消息，但这需要你先用代码设置监听方法（更多信息请参见<span class="notranslate">GML</span> "<a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sequences/Sequence_Events_Moments_Broadcast.htm">序列事件和时刻</a>"部分）。</p>
  <p class="note"><strong><span class="note">注意</span></strong>将一个实例的<strong>image_index </strong>直接设置为一帧，<em>不会</em>触发该对象的<span class="notranslate">sprite</span> ，该帧上可能存在的任何广播信息。</p>
  <p>要将广播信息添加到<span class="notranslate">sequence</span> 或<span class="notranslate">sprite</span> <span class="notranslate">timeline</span> ，你只需点击<img> 按钮。这将打开一个对话框，你可以添加要广播的信息。</p>
  <p class="dropspot"><img alt="Broadcast Message Button Icon" class="icon" src="../../assets/Images/Icons/Icon_Broadcast.png" /></p>
  <p>一旦添加，该消息将显示在<span class="notranslate">Dope Sheet</span> （或在<span class="notranslate">sprite</span> 框架视图中）。要编辑它，你必须在信息图标上点击鼠标右键<img> ，打开所有与框架重叠的信息列表（一个框架上只能有一条信息，但在连续的框架上放置多条信息会导致它们在视觉上重叠，使你更难选择你想要的信息，你也可以在同一框架上有一条信息和一个<a href="../../GameMaker_Language/GML_Reference/Asset_Management/Sequences/Sequence_Events_Moments_Broadcast.htm">时刻</a>），然后从这个列表中选择一个，将打开信息对话框，你可以编辑它或删除它。</p>
  <p>当广播信息事件被触发时，会有一个特殊的<a href="../../GameMaker_Language/GML_Reference/Data_Structures/DS_Maps/DS_Maps.htm">DS地图</a>被创建并存储在内置变量 <span class="inline">event_data</span> 。这个变量ID是一个内置的<em>全局 </em>范围变量，但只在触发它的事件中包含DS地图数据--在这种情况下是广播信息事件--在其他时候都会返回-1。该事件将拥有的键如下。</p>
  <table>
    <colgroup>
      <col />
      <col />
      <col />
    </colgroup>
    <tbody>
      <tr>
        <th colspan="3"><span data-keyref="Type_Struct_Message_Event"><a data-rhwidget="HyperlinkPopover" href="../../../The_Asset_Editors/Sequence_Properties/Broadcast_Messages.htm">消息事件结构</a></span></th>
      </tr>
      <tr>
        <th>变化的</th>
        <th>类型</th>
        <th>描述</th>
      </tr>
      <tr>
        <td><span class="inline">event_type</span></td>
        <td><span data-keyref="Type_String"><a data-rhwidget="HyperlinkPopover" href="../../../GameMaker_Language/GML_Overview/Data_Types.htm">字符串</a></span></td>
        <td>这将是<span class="notranslate">string</span> &quot;<span class="inline">sequence event</span>&quot; ，用于从<span class="notranslate">Sequence</span> 发送的信息； &quot;<span class="inline">sprite event</span>&quot; 用于从<span class="notranslate">Sprite</span> 发送的信息。</td>
      </tr>
      <tr>
        <td><span class="inline">message</span></td>
        <td><span data-keyref="Type_String"><a data-rhwidget="HyperlinkPopover" href="../../../GameMaker_Language/GML_Overview/Data_Types.htm">字符串</a></span></td>
        <td>这包含已经收到的消息<span class="notranslate">string</span> 。</td>
      </tr>
      <tr>
        <td><span class="inline">element_id</span></td>
        <td><span data-keyref="Type_ID_Layer_Element"><a data-rhwidget="HyperlinkPopover" href="../../../GameMaker_Language/GML_Reference/Asset_Management/Rooms/General_Layer_Functions/layer_get_all_elements.htm">层元素ID</a></span></td>
        <td>这包含了触发该消息的层元素（序列/分叉/实例）的ID。然后，你可以使用这个ID值来找出是哪种元素产生了这个消息，使用函数 <a href="../../GameMaker_Language/GML_Reference/Asset_Management/Rooms/General_Layer_Functions/layer_get_element_type.htm"><span class="inline">layer_get_element_type()</span></a>并使用其他相关的函数来锁定它，或者根据需要执行一个动作，如播放一个声音。</td>
      </tr>
    </tbody>
  </table>
  <p>请注意，一个实例的广播消息事件在每次发送广播消息的时候都会收到多个<span class="notranslate">strings</span> 。你不需要对它们全部采取行动，可以让不同的实例监听不同的广播<span class="notranslate">strings</span> 。然而，你可能有一个实例正在监听可能同时收到的消息。当这种情况发生时，事件将被多次触发--<em>对每个消息字符串触发一次</em>。</p>
  <p>下面是一个简单的例子，说明如何检查这个事件。</p>
  <p class="code">if event_data[? &quot;event_type&quot;] == &quot;sequence event&quot; // or you can check &quot;sprite event&quot;<br />
    {<br />
        switch (event_data[? &quot;message&quot;])<br />
        {<br />
            case &quot;hit&quot;:<br />
                audio_play_sound(snd_hit, 0, false);<br />
            break;<br />
    <br />
            case &quot;destroy&quot;:<br />
                sequence_destroy(event_data[? &quot;element_id&quot;]);<br />
            break;<br />
        }<br />
    }
  </p>
  <p> </p>
  <p> </p>
  <p> </p>
  <div class="footer">
    <div class="buttons">
      <div class="clear">
        <div style="float:left">返回。<a href="../Sequences.htm">序列</a></div>
        <div style="float:right">下一步。<a href="The_Sequence_Canvas.htm"> <span class="notranslate">Sequence</span> Canvas</a></div>
      </div>
    </div>
    <h5><span data-keyref="Copyright Notice">© Copyright<span class="notranslate">YoYo Games Ltd.</span> 2022 All Rights Reserved</span></h5>
  </div>
  <!-- KEYWORDS
Sequences - Broadcast Messages
Broadcast Messages
-->
  <!-- TAGS
sequences_broadcast_messages
-->
</body>
</html>