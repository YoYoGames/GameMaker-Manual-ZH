<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>全局变量</title>
  <meta name="generator" content="Adobe RoboHelp 2020" />
  <link rel="stylesheet" href="../../../assets/css/default.css" type="text/css" />
  <script src="../../../assets/scripts/main_script.js"></script>
  <meta name="rh-authors" content="Mark Alexander" />
  <meta name="topic-comment" content="Page explaining global variables" />
  <meta name="rh-index-keywords" content="global,globalvar,Global Variables" />
  <meta name="search-keywords" content="global,global variables,globalvar" />
</head>
<body>
  <!--<div class="body-scroll" style="top: 150px;">-->
  <h1>全局变量</h1>
  <p>对<strong>全局变量 </strong>的基本描述是：一旦声明，它就不属于任何特定的实例，但却可以被所有人访问。就像<a href="Local_Variables.htm">局部变量</a>一样，全局变量必须用一个标识符来声明，但与局部变量不同的是，全局变量在<em>游戏结束前一直</em>留在内存中。因此，你可以创建一个全局变量来记录（例如）玩家拥有的子弹数量，然后在游戏中的不同时间点更新这个变量，形成任何实例或函数，并在任何时候更新。从本质上讲，全局变量不属于任何特定的实例，可以被所有的实例访问、改变和使用，对该变量的任何改变都是 &quot;全局的&quot;，因为所有使用该变量的实例都会受到改变的影响。让我们来看看一个例子。</p>
  <p class="code">global.food = 5;</p>
  <p>我们声明 &quot;<span class="inline">food</span>&quot; 变量时，先写 &quot;<span class="inline">global</span>&quot; ，然后写 &quot;<span class="inline">.</span>&quot; ，告诉<span data-keyref="GameMaker Name">GameMaker</span>这个变量现在是全局范围。从现在开始，当我们需要以任何方式访问或改变这个变量时，我们将需要使用这种形式。所以，我们已经创建了一个新的变量，叫做 &quot;<span class="inline">food</span>&quot; ，并声明它是全局的。现在，任何实例或函数都可以以任何方式使用和改变这个变量，所有其他实例都会 &quot;看到 &quot;这个变量。例如，我们可以有一个不同的食物<span class="notranslate">object</span> ，玩家与之发生碰撞，在碰撞事件中我们有。</p>
  <p class="code">global.food +=1;</p>
  <p>我们还有另一个<span class="notranslate">object</span> ，它像这样画出这个值。</p>
  <p class="code">draw_text(32, 32, &quot;food = &quot; + string(global.food));</p>
  <p>通过全局变量，我们可以改变数值，并看到这些变化反映在所有引用该变量的<span class="notranslate">objects</span> 实例中。和<i>局部变量</i>一样，你必须注意不要把你的全局变量的名字和任何实例变量的名字一样，因为这可能会给你带来问题，并且由于变量的重叠而使错误悄悄进入你的游戏，这有时是一个很难调试的问题。一般来说，你应该在游戏开始时（例如，在游戏的第一个对象实例的<a href="../../../The_Asset_Editors/Object_Properties/Other_Events.htm">房间开始事件</a>中<span class="notranslate">object</span> ）有一个单一的<span class="notranslate">room</span> ，声明你所有的全局变量，或者有一个单一的<a href="../Script_Functions.htm">脚本函数</a>来声明它们，因为这给你一个方便的地方，如果你需要检查一个变量的名称或编辑一个值，可以一次性地引用所有的变量。</p>
  <p><span data-keyref="GameMaker Name">GameMaker</span>也有一系列 &quot;内置 &quot;的全局变量，所以你应该注意它们，因为你可能会把你的一个实例变量命名为相同的名字，或者希望有你自己的全局变量有相同的名字，并想知道为什么你会得到错误！但是，它们很容易被发现，因为它们在代码编辑器中显示为不同的颜色，并在底部的自动完成栏中出现。然而，它们很容易被发现，因为它们在代码编辑器中以不同的颜色显示，也会出现在底部的自动完成栏中。大多数内置的全局变量都有非常具体的用途，在手册的相应章节中列出 - 但是有两个重要的全局变量经常使用，而且没有在其他地方列出。</p>
  <ul class="colour">
    <li><span class="inline"><a data-xref="{title}" href="Builtin_Global_Variables/async_load.htm">async_load</a></span></li>
    <li><span class="inline"><a data-xref="{title}" href="../../GML_Reference/Game_Input/Gesture_Input/event_data.htm">event_data</a></span></li>
  </ul>
  <p>还有三个<b>废弃的</b>内置全局变量，你应该知道（这些变量只是为了支持<span class="notranslate">GameMaker</span> 以前版本的遗留项目而设计的，并且应该 <b><i>不能在新项目中使用</i></b>):</p>
  <ul class="colour">
    <li><span class="inline"><a data-xref="{title}" href="Builtin_Global_Variables/score.htm">score</a></span></li>
    <li><span class="inline"><a data-xref="{title}" href="Builtin_Global_Variables/health.htm">health</a></span></li>
    <li><span class="inline"><a data-xref="{title}" href="Builtin_Global_Variables/lives.htm">lives</a></span></li>
  </ul>
  <p>最后，有两个变量可用于<span class="notranslate">script</span> 函数和方法。</p>
  <ul class="colour">
    <li><a data-xref="{title}" href="Builtin_Global_Variables/argument.htm">argument</a></li>
    <li><a data-xref="{title}" href="Builtin_Global_Variables/argument_count.htm">argument_count</a></li>
  </ul>
  <p>下面的形式也可以用来声明全局变量，但它是 <i><b>只是为了向后兼容而包括在内</b></i>，不建议你在新项目中使用这种形式，因为未来版本的<span class="notranslate">GameMaker</span> 可能不支持它。</p>
  <p>创建全局变量的第二种形式是使用 <span class="inline">globalvar</span> 声明，就像使用 <span class="inline">var</span> 声明一个局部变量一样，将它们声明为全局变量。</p>
  <p class="note"><b>重要的是!</b> <span class="inline">globalvar</span> 声明已<b>被弃</b>用，只支持用于遗留用途。你应该<b>始终</b>使用 <span class="inline">global.</span> 标识符来标记全局变量。</p>
  <p>这个（废弃的）声明将被用于以下方面。</p>
  <p class="code">globalvar food;<br />
    food = 5;</p>
  <p>一旦以这种方式声明，该变量 &quot;food &quot;现在被认为是全局性的，不需要 <span class="inline">global.</span> 前缀--这也意味着在你的代码中识别全局变量要难得多，而且当你在不同的<span class="notranslate">objects</span> ，或者从你安装的<span class="notranslate">extensions</span> ，也更容易出现变量重叠的现象。一旦以这种方式声明，全局变量的访问方式如下。</p>
  <p class="code">food += 2;</p>
  <p>或。</p>
  <p class="code">draw_text(32, 32, &quot;food = &quot; + string(food));</p>
  <p>正如你所看到的，如果没有任何东西表明这个变量是全局范围的，你就有可能为你的游戏中出现的许多微妙问题埋下伏笔，这就是为什么应该避免这种声明。</p>
  <p>在处理全局变量时，有几个函数旨在帮助你，你可以在下面的页面上找到这些函数。</p>
  <ul class="colour">
    <li><a href="../../GML_Reference/Variable_Functions/Variable_Functions.htm">变量函数</a></li>
  </ul>
  <p> </p>
  <p> </p>
  <p> </p>
  <div class="footer">
    <div class="buttons">
      <div class="clear">
        <div style="float:left">回来。<a href="../Variables_And_Variable_Scope.htm">变量和变量范围</a></div>
        <div style="float:right">下一步。<a href="Constants.htm">常数</a></div>
      </div>
    </div>
    <h5><span data-keyref="Copyright Notice">© Copyright<span class="notranslate">YoYo Games Ltd.</span> 2022 All Rights Reserved</span></h5>
  </div>
  <!-- KEYWORDS
global
globalvar
global variables
-->
  <!-- TAGS
global_variables
-->
</body>
</html>